Connecting to database specified by database.yml
  [1m[36m (0.4ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.7ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.4ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (6.3ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (1.2ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.9ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.8ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.3ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.2ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.4ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (19.7ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365282183], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "6a2ae6d61daebf3ac704d026fe0f6251bf45fea8968c0f755e8fe2a674ad1812"], ["updated_at", Sat, 06 Apr 2013 21:03:04 UTC +00:00]]
  [1m[35m (0.2ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.6ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  begin transaction
  [1m[36mSQL (1.3ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365282184], ["expires_at", 1365282484], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.2ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-06 23:03:04 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.4ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.4ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessToken Load (0.2ms)[0m  SELECT "access_tokens".* FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365282184) and identity = 'Batman' and client_id = 1 and revoked is null)

ActiveRecord::UnknownAttributeError (unknown attribute: _id):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.4ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.6ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.4ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (3.3ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (1.2ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.7ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.5ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.2ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.4ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.2ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (13.7ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365282401], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "1203d30556acb86040cfac276f5c189ed07f5ca88d95273353ef0980e26d082d"], ["updated_at", Sat, 06 Apr 2013 21:06:41 UTC +00:00]]
  [1m[35m (0.2ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.4ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  begin transaction
  [1m[36mSQL (1.1ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365282401], ["expires_at", 1365282701], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.1ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-06 23:06:42 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.4ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.2ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m

NoMethodError (undefined method `new_instance' for Rack::OAuth2::Server:Class):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.1ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (4.7ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (8.8ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365285927], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "f6a4c99b24c98f32cff3037383a20ad85eabecb03f7ef327adbd2397212d4583"], ["updated_at", Sat, 06 Apr 2013 22:05:27 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365285927], ["expires_at", 1365286227], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:05:27 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m

NoMethodError (undefined method `new_instance' for Rack::OAuth2::Server:Class):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (1.5ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (5.8ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286037], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "77641e01709e575fccab7caa737abcccb361ebd8f4f9d74e16fe7ffb9aa85271"], ["updated_at", Sat, 06 Apr 2013 22:07:17 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286037], ["expires_at", 1365286337], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.1ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:07:17 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m

NoMethodError (undefined method `new_instance' for Rack::OAuth2::Server:Class):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.1ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (1.2ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (4.9ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286304], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "648291f32828d8f7aaf85e78263d2936224e95025f476344d679a407d9bc496f"], ["updated_at", Sat, 06 Apr 2013 22:11:44 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286304], ["expires_at", 1365286604], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:11:44 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessToken Load (0.1ms)[0m  SELECT "access_tokens".* FROM "access_tokens" WHERE "access_tokens"."token" IN (SELECT "access_tokens"."id" FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286304) and identity = 'Batman' and client_id = 1 and revoked is null)) LIMIT 1

NoMethodError (undefined method `token' for nil:NilClass):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.2ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.4ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.3ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (2.6ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.5ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.4ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (8.2ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286344], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "b9395c3ec97843b70448e37be923689d262d726c395e448e85e7ee1cc157a590"], ["updated_at", Sat, 06 Apr 2013 22:12:25 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.7ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286345], ["expires_at", 1365286645], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.1ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:12:25 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.2ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286345) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Binary data inserted for `string` type on column `token`
  [1m[35mSQL (4.3ms)[0m  INSERT INTO "access_tokens" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope", "token") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["access_token", nil], ["client_id", 1], ["created_at", 1365286345], ["expires_at", 1365372745], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", nil], ["revoked", nil], ["scope", ["read"]], ["token", "b690e51e19bfd7e0cf72c2377b9056836004ab817090c41625f654cf5116ddd1"]]
  [1m[36m (0.1ms)[0m  [1mcommit transaction[0m

NoMethodError (undefined method `tokens_granted' for #<Rack::OAuth2::Server::Client:0x007fc55eda07e8>):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.1ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (1.3ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "tokens_granted" integer, "tokens_revoked" integer, "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (9.0ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "tokens_granted", "tokens_revoked", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286744], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "79ef3bcad7c4fd5ca70f05ca186a2c20f3b99d4b8ab4ee603a6f0a04aead3df0"], ["tokens_granted", nil], ["tokens_revoked", nil], ["updated_at", Sat, 06 Apr 2013 22:19:04 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286744], ["expires_at", 1365287044], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:19:04 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286744) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Binary data inserted for `string` type on column `token`
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "access_tokens" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope", "token") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["access_token", nil], ["client_id", 1], ["created_at", 1365286744], ["expires_at", 1365373144], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", nil], ["revoked", nil], ["scope", ["read"]], ["token", "1747787e1a14c5fdd6d76c56eda88da4264a035b4fafc0b395e1951f1ae0e11a"]]
  [1m[36m (0.0ms)[0m  [1mcommit transaction[0m

NoMethodError (undefined method `+' for nil:NilClass):
  test/oauth/server_methods_test.rb:158:in `block (2 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.1ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (1.3ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "tokens_granted" integer DEFAULT 0, "tokens_revoked" integer DEFAULT 0, "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "tokens_granted", "tokens_revoked", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286778], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "5917ae084ed53e1613fa6a2a8aa80104edb39af3db412e88ca8b405b9d3813d8"], ["tokens_granted", 0], ["tokens_revoked", 0], ["updated_at", Sat, 06 Apr 2013 22:19:38 UTC +00:00]]
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286778], ["expires_at", 1365287078], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:19:38 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286778) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Binary data inserted for `string` type on column `token`
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "access_tokens" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope", "token") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["access_token", nil], ["client_id", 1], ["created_at", 1365286778], ["expires_at", 1365373178], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", nil], ["revoked", nil], ["scope", ["read"]], ["token", "20bb8a0a2b2cc9fbc33ad16b63f7cc3856c3fc81fbc71e7631a5e449f0aa0783"]]
  [1m[36m (0.0ms)[0m  [1mcommit transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mUPDATE "clients" SET "tokens_granted" = 1, "updated_at" = '2013-04-06 22:19:38.330208' WHERE "clients"."id" = 1[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  [1mSELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1[0m  [["id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1  [["id", 1]]
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286778], ["expires_at", 1365287078], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:20:38 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 2 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286838) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36mRack::OAuth2::Server::AccessToken Load (0.1ms)[0m  [1mSELECT "access_tokens".* FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286838) and identity = 'Batman' and client_id = 1 and revoked is null)[0m

NoMethodError (undefined method `token' for #<ActiveRecord::Relation:0x007fa93e63c5b0>):
  test/oauth/server_methods_test.rb:204:in `block (4 levels) in <class:ServerTest>'
  test/oauth/server_methods_test.rb:201:in `block (3 levels) in <class:ServerTest>'


Connecting to database specified by database.yml
  [1m[36m (0.1ms)[0m  [1mselect sqlite_version(*)[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "schema_migrations" ("version" varchar(255) NOT NULL) 
  [1m[36m (0.1ms)[0m  [1mCREATE UNIQUE INDEX "unique_schema_migrations" ON "schema_migrations" ("version")[0m
  [1m[35m (1.3ms)[0m  SELECT "schema_migrations"."version" FROM "schema_migrations" 
Migrating to CreateTables (20130401)
  [1m[36m (0.0ms)[0m  [1mbegin transaction[0m
  [1m[35m (0.3ms)[0m  CREATE TABLE "clients" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "secret" varchar(255) DEFAULT '' NOT NULL, "scope" varchar(255) DEFAULT '' NOT NULL, "redirect_uri" varchar(255) DEFAULT '' NOT NULL, "display_name" varchar(255) DEFAULT '' NOT NULL, "link" varchar(255), "image_url" varchar(255), "notes" varchar(255), "tokens_granted" integer DEFAULT 0, "tokens_revoked" integer DEFAULT 0, "revoked" boolean, "created_at" datetime NOT NULL, "updated_at" datetime NOT NULL) 
  [1m[36m (0.2ms)[0m  [1mCREATE TABLE "access_grants" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) [0m
  [1m[35m (0.2ms)[0m  CREATE TABLE "access_tokens" ("id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, "identity" varchar(255), "scope" varchar(255), "token" varchar(255), "client_id" integer, "redirect_uri" varchar(255), "created_at" integer, "expires_at" integer, "granted_at" integer, "access_token" varchar(255), "revoked" varchar(255)) 
  [1m[36m (0.1ms)[0m  [1mINSERT INTO "schema_migrations" ("version") VALUES ('20130401')[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."secret" IS NULL LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
Binary data inserted for `string` type on column `secret`
  [1m[36mSQL (1.8ms)[0m  [1mINSERT INTO "clients" ("created_at", "display_name", "image_url", "link", "notes", "redirect_uri", "revoked", "scope", "secret", "tokens_granted", "tokens_revoked", "updated_at") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["created_at", 1365286893], ["display_name", "UberClient"], ["image_url", nil], ["link", nil], ["notes", ""], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]], ["secret", "7b1be6fd8eba1dcd5bb2c2f6935eeda16b97781e356db04b31db3316fa8ffe8b"], ["tokens_granted", 0], ["tokens_revoked", 0], ["updated_at", Sat, 06 Apr 2013 22:21:33 UTC +00:00]]
  [1m[35m (0.1ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286893], ["expires_at", 1365287193], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["read"]]]
  [1m[35m (0.0ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:21:33 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 1 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286893) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36m (0.1ms)[0m  [1mbegin transaction[0m
Binary data inserted for `string` type on column `token`
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "access_tokens" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope", "token") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)  [["access_token", nil], ["client_id", 1], ["created_at", 1365286893], ["expires_at", 1365373293], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", nil], ["revoked", nil], ["scope", ["read"]], ["token", "f072297953cdd15601cc816e37740fb46ec93b259264318afec0e84b30dc4636"]]
  [1m[36m (0.0ms)[0m  [1mcommit transaction[0m
  [1m[35m (0.0ms)[0m  begin transaction
  [1m[36m (0.1ms)[0m  [1mUPDATE "clients" SET "tokens_granted" = 1, "updated_at" = '2013-04-06 22:21:33.189447' WHERE "clients"."id" = 1[0m
  [1m[35m (0.0ms)[0m  commit transaction
  [1m[36mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  [1mSELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1[0m  [["id", 1]]
  [1m[35mCACHE (0.0ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1  [["id", 1]]
  [1m[36mRack::OAuth2::Server::Client Load (0.1ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.1ms)[0m  begin transaction
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "access_grants" ("access_token", "client_id", "created_at", "expires_at", "granted_at", "identity", "redirect_uri", "revoked", "scope") VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)[0m  [["access_token", nil], ["client_id", 1], ["created_at", 1365286893], ["expires_at", 1365287193], ["granted_at", nil], ["identity", "Batman"], ["redirect_uri", "http://uberclient.dot/callback"], ["revoked", nil], ["scope", ["oauth-admin", "read", "write"]]]
  [1m[35m (0.1ms)[0m  commit transaction
Started POST "/oauth/access_token" for 127.0.0.1 at 2013-04-07 00:22:33 +0200
  [1m[36mRack::OAuth2::Server::Client Load (0.2ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = 2 AND "access_grants"."revoked" IS NULL LIMIT 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "clients".* FROM "clients" WHERE "clients"."id" = 1 LIMIT 1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286953) and identity = 'Batman' and client_id = 1 and revoked is null)
  [1m[36mRack::OAuth2::Server::AccessToken Load (0.1ms)[0m  [1mSELECT "access_tokens".* FROM "access_tokens" WHERE ((expires_at is null or expires_at >= 1365286953) and identity = 'Batman' and client_id = 1 and revoked is null) LIMIT 1[0m
  [1m[35mRack::OAuth2::Server::AccessGrant Load (0.1ms)[0m  SELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1  [["id", 2]]
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "access_grants".* FROM "access_grants" WHERE "access_grants"."id" = ? LIMIT 1[0m  [["id", 2]]
